check_simulations:
	R --slave < check_simulations.R

check_distributions:
	rm -rf autogenerated.*
	R --slave < check_distributions.R

matrix_arrays:
	R --slave < matrix_arrays.R

report:
	R --slave < report.R

test_reload:
	R --slave < test_reload.R

test_protect:
	R --slave < test_protect.R

clean :
	rm -rf *.o *.so *.dll *~ core *.output.RData *.pdf *.profile
	rm -rf */*.o */*.so */*.dll */*~ core */*.output.RData */*.pdf */*.profile

##########################################################
## For travis tests

## Check that syntax is not broken for projects that depend on TMB
glmmTMB:
	wget http://rawgit.com/glmmTMB/glmmTMB/master/glmmTMB/src/glmmTMB.cpp
	wget http://rawgit.com/glmmTMB/glmmTMB/master/glmmTMB/src/init.h
	Rscript -e 'TMB:::compile("glmmTMB.cpp",libinit=FALSE)'
spict:
	wget http://rawgit.com/mawp/spict/master/spict/src/spict.cpp
	Rscript -e 'TMB:::compile("spict.cpp")'

test:
	make test_protect
	make check_simulations
	make report
	make glmmTMB
	make spict
